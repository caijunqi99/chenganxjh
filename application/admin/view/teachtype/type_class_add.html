{include file="public/header" /}
<link rel="stylesheet" href="{$Think.config.url_domain_root}static/plugins/layer/css/layui.css">
<div id="append_parent"></div>
<div id="ajaxwaitid"></div>
<div class="page">
    <div class="fixed-bar">
        <div class="item-title">
            <div class="subject">
                <h3>添加分类管理</h3>
            </div>
            {include file="public/admin_items" /}
        </div>
    </div>
    <div class="explanation" id="explanation">
        <div class="title" id="checkZoom">
            <h4 title="提示相关设置操作时应注意的要点">操作提示</h4>
            <span id="explanationZoom" title="收起提示" class="arrow"></span>
        </div>
        <ul>
            <li>添加分类名称。</li>
            <li>切换不要把顶级分类整体移动到其它分类下。</li>
            <li>如果选择上级分类，那么新增的分类则为被选择上级分类的子分类。</li>
            <li>数字越小越靠前。</li>
        </ul>
    </div>

    <form id="goods_class_form" enctype="multipart/form-data" method="post" class="layui-form">
        <input type="hidden" name="form_submit" value="ok" />
        <div  class="ncap-form-default">
            <div class="layui-form-item">
                <div class="layui-inline">
                    <label class="layui-form-label">{$Think.lang.teacher_type_index_name}：</label>
                    <div class="layui-input-inline">
                        <input id="gc_name" name="gc_name"  type="text" value=""  class="layui-input">
                        <span class="err"></span>
                    </div>
                </div>
            </div>
            <div class="layui-form-item">
                <div class="layui-inline">
                    <label class="layui-form-label">{$Think.lang.teacher_class_add_sup_class}：</label>
                    <div class="layui-input-inline">
                        <select name="gc_parent_id" id="gc_parent_id" class="select">
                            <option value="0">{$Think.lang.ds_please_choose}...</option>
                            <?php if(!empty($parent_list) && is_array($parent_list)){ ?>
                            <?php foreach($parent_list as $k => $v){ ?>
                            <option value="<?php echo $v['gc_id'];?>"><?php echo $v['gc_name'];?></option>
                            <?php } ?>
                            <?php } ?>
                        </select>
                        <span class="err"></span>
                    </div>
                </div>
            </div>
            <div class="layui-form-item">
                <div class="layui-inline">
                    <label class="layui-form-label">{$Think.lang.ds_sort}：</label>
                    <div class="layui-input-inline">
                        <input id="gc_sort" name="gc_sort"  type="text" value=""  class="layui-input">
                        <span class="err"></span>
                    </div>
                </div>
            </div>
            <div class="layui-form-item">
                <div class="layui-input-block">
                    <a href="JavaScript:void(0);" class="btn" id="submitBtn">确认提交</a>
                </div>
            </div>
        </div>
    </form>
</div>
<script>
    layui.use(['form','laypage', 'layer'], function(){
        var form = layui.form,
            laypage = layui.laypage
            ,layer = layui.layer;
    });
//按钮先执行验证再提交表单
              $(function() {


                  $("#submitBtn").click(function() {
                      if ($("#goods_class_form").valid()) {
                          $("#goods_class_form").submit();
                      }
                  });

                  $('#goods_class_form').validate({
                      errorPlacement: function(error, element) {
                          error.appendTo(element.nextAll('span.err'));
                      },
                      rules: {
                          gc_name: {
                              required: true,
                              remote: {
                                  url: "{:url('/Admin/Teachtype/ajax',['branch'=>'check_class_name'])}",
                                  type: 'get',
                                  data: {
                                      gc_name: function() {
                                          return $('#gc_name').val();
                                      },
                                      gc_parent_id: function() {
                                          return $('#gc_parent_id').val();
                                      },
                                      gc_id: ''
                                  }
                              }
                          },
                          gc_sort: {
                              number: true
                          }
                      },
                      messages: {
                          gc_name: {
                              required: '{$Think.lang.goods_class_add_name_null}',
                              remote: '{$Think.lang.goods_class_add_name_exists}'
                          },
                          gc_sort: {
                              number: '{$Think.lang.goods_class_add_sort_int}'
                          }
                      }
                  });

              });

</script> 
